library(rgl)
my_data <- read.delim("HCP.dat", header = FALSE, sep = "\t", dec = ".")
x <- my_data$V1
y <- my_data$V2
z <- my_data$V3
rad <- 0.1
rgl.open()
par3d(windowRect = c(20, 30, 800, 800))
rgl.bg(color = "white")
rgl.viewpoint(theta = 0, phi = -60, zoom = 0.9)
rgl.spheres(x, y, z, radius = rad, color = "lightgray")
arrow3d(c(0, 0, 0), c(3, 0, 0), s = 0, type = "lines", col = "black")
arrow3d(c(0.5, 0.866, 0), c(2.5, 0.866, 0), s = 0, type = "lines", col = "black")
arrow3d(c(0.5, -0.866, 0), c(2.5, -0.866, 0), s = 0, type = "lines", col = "black")
arrow3d(c(0.5, 0.866, 0), c(1.5, -0.866, 0), s = 0, type = "lines", col = "black")
arrow3d(c(1.5, 0.866, 0), c(2.5, -0.866, 0), s = 0, type = "lines", col = "black")
arrow3d(c(1.5, 0.866, 0), c(0.5, -0.866, 0), s = 0, type = "lines", col = "black")
arrow3d(c(2.5, 0.866, 0), c(1.5, -0.866, 0), s = 0, type = "lines", col = "black")
arrow3d(c(0, 0, 0), c(0.5, 0.866, 0), s = 0, type = "lines", col = "black")
arrow3d(c(0, 0, 0), c(0.5, -0.866, 0), s = 0, type = "lines", col = "black")
arrow3d(c(3, 0, 0), c(2.5, 0.866, 0), s = 0, type = "lines", col = "black")
arrow3d(c(3, 0, 0), c(2.5, -0.866, 0), s = 0, type = "lines", col = "black")

arrow3d(c(0, 0, 2), c(3, 0, 2), s = 0, type = "lines", col = "black")
arrow3d(c(0.5, 0.866, 2), c(2.5, 0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(0.5, -0.866, 2), c(2.5, -0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(0.5, 0.866, 2), c(1.5, -0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(1.5, 0.866, 2), c(2.5, -0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(1.5, 0.866, 2), c(0.5, -0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(2.5, 0.866, 2), c(1.5, -0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(0, 0, 2), c(0.5, 0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(0, 0, 2), c(0.5, -0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(3, 0, 2), c(2.5, 0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(3, 0, 2), c(2.5, -0.866, 2), s = 0, type = "lines", col = "black")


arrow3d(c(0, 0, 0), c(0, 0, 2), s = 0, type = "lines", col = "black")
arrow3d(c(1, 0, 0), c(1, 0, 2), s = 0, type = "lines", col = "black")
arrow3d(c(2, 0, 0), c(2, 0, 2), s = 0, type = "lines", col = "black")
arrow3d(c(3, 0, 0), c(3, 0, 2), s = 0, type = "lines", col = "black")
arrow3d(c(0.5, 0.866, 0), c(0.5, 0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(1.5, 0.866, 0), c(1.5, 0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(2.5, 0.866, 0), c(2.5, 0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(0.5, -0.866, 0), c(0.5, -0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(1.5, -0.866, 0), c(1.5, -0.866, 2), s = 0, type = "lines", col = "black")
arrow3d(c(2.5, -0.866, 0), c(2.5, -0.866, 2), s = 0, type = "lines", col = "black")

arrow3d(c(1, 1.1547, 1), c(2, -0.57735, 1), s = 0, type = "lines", col = "black")
arrow3d(c(2, 1.1547, 1), c(1, -0.57735, 1), s = 0, type = "lines", col = "black")
arrow3d(c(0.5, 0.2887, 1), c(1, -0.57735, 1), s = 0, type = "lines", col = "black")
arrow3d(c(2, 1.1547, 1), c(2.5, 0.2887, 1), s = 0, type = "lines", col = "black")
arrow3d(c(2, -0.57735, 1), c(2.5, 0.2887, 1), s = 0, type = "lines", col = "black")
arrow3d(c(0.5, 0.2887, 1), c(1, 1.1547, 1), s = 0, type = "lines", col = "black")
arrow3d(c(1, -0.57735, 1), c(2, -0.57735, 1), s = 0, type = "lines", col = "black")
arrow3d(c(1, 1.1547, 1), c(2, 1.1547, 1), s = 0, type = "lines", col = "black")
arrow3d(c(0.5,0.2887, 1), c(2.5, 0.2887, 1), s = 0, type = "lines", col = "black")

text3d(x = 2, y = -0.5, z = 0, texts = "a1", cex = 1.2, color = "black")
arrow3d(c(2.5, -0.866, 0), c(2.05, -0.087, 0), s = 1/5, type = "rotation", col = "black")
text3d(x = 3, y = -0.5, z = 0, texts = "a2", cex = 1.2, color = "black")
arrow3d(c(2.5, -0.866, 0), c(2.95, -0.087, 0), s = 1/5, type = "rotation", col = "black")
text3d(x = 2.3, y = -0.5, z = 0.7, texts = "a3", cex = 1.2, color = "black")
arrow3d(c(2.5, -0.866, 0), c(2.04, -0.58, 0.93), s = 1/5, type = "rotation", col = "black")
rglwidget()